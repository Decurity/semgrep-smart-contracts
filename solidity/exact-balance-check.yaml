rules:
 -
    id: exact-balance-check
    message: Testing the balance of an account as a basis for some action has risks associated with unexpected receipt of ether or another token, including tokens deliberately transfered to cause such tests to fail, as an MEV attack.
    metadata:
      category: logic
      references:
        - https://entethalliance.org/specs/ethtrust-sl/v1/#req-1-exact-balance-check
    mode: taint
    pattern-sinks:
      - pattern: require(...)
    pattern-sources:
        - pattern-either:
            - pattern: $T.balanceOf(...) == ...
            - pattern: $T.balance == ...
    languages: 
      - solidity
    severity: ERROR
