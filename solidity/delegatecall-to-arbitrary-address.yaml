rules:
  - id: delegatecall-to-arbitrary-address
    message: An attacker may perform delegatecall() to an arbitrary address.
    metadata:
        references:
        - https://entethalliance.org/specs/ethtrust-sl/v1/#req-1-delegatecall
        category: controlled-delegatecall
        tags:
          - ethtrust
    languages: [solidity]
    severity: ERROR
    mode: taint
    pattern-sources:
      - patterns:
        - pattern-either:
          - pattern: function $ANY(..., address $CONTRACT, ...) {...}
          - pattern: function $ANY(..., address payable $CONTRACT, ...) {...}
        - focus-metavariable: $CONTRACT
    pattern-sinks:
      - patterns:
        - pattern: $CONTRACT.delegatecall(...);
        - focus-metavariable: $CONTRACT
    
