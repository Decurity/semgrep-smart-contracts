rules:
- id: thirdweb-vulnerability
  pattern-either:
    - pattern-regex: 'import ".*\/(.*)(e|E)(r|R)(c|C)2771(.*)\.sol";((.|\n)*)import ".*\/(.*)(m|M)(u|U)(l|L)(t|T)(i|I)(c|C)(a|A)(l|L)(l|L)(.*)\.sol";'
    - pattern-regex: 'import ".*\/(.*)(m|M)(u|U)(l|L)(t|T)(i|I)(c|C)(a|A)(l|L)(l|L)(.*)\.sol";((.|\n)*)import ".*\/(.*)(e|E)(r|R)(c|C)2771(.*)\.sol";'
  message: |
      In contracts that support Multicall and ERC2771Context an Arbitrary Address Spoofing attack is possible.
  languages: [solidity]
  severity: ERROR
  metadata: 
      category: security
      technology:
        - solidity
      cwe: "CWE-937: Using Components with Known Vulnerabilities"
      confidence: HIGH
      likelihood: HIGH
      impact: HIGH
      subcategory:
        - vuln
      references:
        - https://blog.thirdweb.com/vulnerability-report/
        - https://dedaub.com/blog/critical-thirdweb-vulnerability
        - https://blog.openzeppelin.com/arbitrary-address-spoofing-vulnerability-erc2771context-multicall-public-disclosure
      
