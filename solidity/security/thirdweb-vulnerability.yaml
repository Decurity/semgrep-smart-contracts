rules:
- id: thirdweb-vulnerability
  pattern-either:
    - pattern-regex: '(?i)import ".*\/(.*)ERC2771(.*)\.sol";((.|\n)*)import ".*\/(.*)Multicall(.*)\.sol";'
    - pattern-regex: '(?i)import ".*\/(.*)Multicall(.*)\.sol";((.|\n)*)import ".*\/(.*)ERC2771(.*)\.sol";'
  message: |
      In contracts that support Multicall and ERC2771Context an Arbitrary Address Spoofing attack is possible.
  languages: [solidity]
  severity: ERROR
  metadata: 
      category: security
      technology:
        - solidity
      cwe: "CWE-937: Using Components with Known Vulnerabilities"
      confidence: HIGH
      likelihood: HIGH
      impact: HIGH
      subcategory:
        - vuln
      references:
        - https://blog.thirdweb.com/vulnerability-report/
        - https://dedaub.com/blog/critical-thirdweb-vulnerability
        - https://blog.openzeppelin.com/arbitrary-address-spoofing-vulnerability-erc2771context-multicall-public-disclosure
      
