rules:
 -
    id: unrestricted-transferownership
    message: Unrestricted transferOwnership
    metadata:
        references:
        - https://medium.com/quillhash/decoding-ragnarok-online-invasion-44k-exploit-quillaudits-261b7e23b55
        - https://www.bscscan.com/address/0xe48b75dc1b131fd3a8364b0580f76efd04cf6e9c
        category: access-control
        tags:
        - ragnarok
    patterns:
        - pattern-not-inside:
            function transferOwnership(address $X) onlyOwner {...}
        - pattern-either:
          - pattern-inside: function transferOwnership(address $X) public {...}
          - pattern-inside: function transferOwnership(address $X) external {...}
        - pattern-not-inside: |
            require(<... msg.sender ...>, ...);
            ...
        - pattern-not-inside: |
            require(<... _msgSender ...>, ...);
            ...
        - pattern-either:
            - pattern: ... = $X
            - pattern: $F(..., $X, ...)

    languages: 
    - solidity
    severity: ERROR
