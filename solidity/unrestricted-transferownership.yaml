rules:
 -
    id: unrestricted-transferownership
    message: Unrestricted transferOwnership
    metadata:
        references:
        - https://medium.com/quillhash/decoding-ragnarok-online-invasion-44k-exploit-quillaudits-261b7e23b55
        - https://www.bscscan.com/address/0xe48b75dc1b131fd3a8364b0580f76efd04cf6e9c
        category: access-control
        tags:
        - ragnarok
    patterns:
        - pattern-either:
          - pattern: function transferOwnership(address $X) public {...}
          - pattern: function transferOwnership(address $X) external {...}
        - pattern-not: |
            function transferOwnership(address $X) onlyOwner {...}
    languages: 
    - solidity
    severity: ERROR
